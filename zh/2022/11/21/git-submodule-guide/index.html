<!doctype html><html lang=zh itemscope itemtype=http://schema.org/WebPage><head><meta name=generator content="Hugo 0.106.0"><meta charset=utf-8><title>Git 子模块使用 · Kohsruhe</title><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=description content="前言 克隆他人项目时，有时候会看到仓库目录下有一个.gitmodules的文本文件，打开后有如下类似内容： [submodule &amp;#34;foo/bar&amp;#34;] path = foo/bar url = https://example.com/foo.git branch = dev 上述内容表面该"><meta name=keywords content="hugo,embedded,programming"><link rel=canonical href=https://www.kohsruhe.com/zh/2022/11/21/git-submodule-guide/><link rel=alternate href=https://www.kohsruhe.com/en/2022/11/21/git-submodule-guide/ hreflang=en><link rel=stylesheet href=https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css integrity=sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO crossorigin=anonymous><link rel=stylesheet href=https://use.fontawesome.com/releases/v5.2.0/css/all.css integrity=sha384-hWVjflwFxL6sNzntih27bfxkr27PmbbK/iSvJ+a4+0owXq79v+lsFkW54bOGbiDQ crossorigin=anonymous><link rel=stylesheet href=https://www.kohsruhe.com/css/den.css><meta property="og:title" content="Git 子模块使用"><meta property="og:description" content="前言 克隆他人项目时，有时候会看到仓库目录下有一个.gitmodules的文本文件，打开后有如下类似内容： [submodule &#34;foo/bar&#34;] path = foo/bar url = https://example.com/foo.git branch = dev 上述内容表面该"><meta property="og:type" content="article"><meta property="og:url" content="https://www.kohsruhe.com/zh/2022/11/21/git-submodule-guide/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-11-21T10:50:19+08:00"><meta property="article:modified_time" content="2022-11-21T10:50:19+08:00"><meta itemprop=name content="Git 子模块使用"><meta itemprop=description content="前言 克隆他人项目时，有时候会看到仓库目录下有一个.gitmodules的文本文件，打开后有如下类似内容： [submodule &#34;foo/bar&#34;] path = foo/bar url = https://example.com/foo.git branch = dev 上述内容表面该"><meta itemprop=datePublished content="2022-11-21T10:50:19+08:00"><meta itemprop=dateModified content="2022-11-21T10:50:19+08:00"><meta itemprop=wordCount content="655"><meta itemprop=keywords content="git,guide,feature,"><meta name=twitter:card content="summary"><meta name=twitter:title content="Git 子模块使用"><meta name=twitter:description content="前言 克隆他人项目时，有时候会看到仓库目录下有一个.gitmodules的文本文件，打开后有如下类似内容： [submodule &#34;foo/bar&#34;] path = foo/bar url = https://example.com/foo.git branch = dev 上述内容表面该"></head><body><div class=header-container style=background:linear-gradient(rgba(0,0,0,.2),rgba(0,0,0,.2)),url(https://www.kohsruhe.com/images/lake.jpeg);background-position:50%;background-size:cover><div class=container><nav class="header-nav navbar navbar-expand-md navbar-dark light-dark"><div class="header-logo navbar-brand"><a class=float-left href=https://www.kohsruhe.com/zh/><img class="mr20 header-logo-image" src=https://www.kohsruhe.com/images/noble.png alt=logo>
Koh</a></div><button class=navbar-toggler type=button data-toggle=collapse data-target=#navbarNav aria-controls=navbarNav aria-expanded=false aria-label="Toggle navigation">
<span class=navbar-toggler-icon></span></button><div class="nav-menu collapse navbar-collapse" id=navbarNav><ul class=navbar-nav><li class=nav-item><a class=nav-link href=https://www.kohsruhe.com/zh/category/newsletters/>周刊</a></li><li class=nav-item><a class=nav-link href=https://www.kohsruhe.com/zh/category/articles/>文章</a></li><li class=nav-item><a class=nav-link href=https://www.kohsruhe.com/zh/category/projects/>项目</a></li><li class=nav-item><a class=nav-link href=https://www.kohsruhe.com/zh/category/thoughts/>杂感</a></li><li class=nav-item><a class=nav-link href=https://www.kohsruhe.com/zh/about/>关于</a></li><li class=nav-item><a class=nav-link href=https://www.kohsruhe.com/en/><i class="fas fa-globe"></i> English</a></li></ul></div></nav></div><div class="container header-wrapper"><div class=row><div class=col-lg-12><div class=header-content><h1 class=header-title>Git 子模块使用</h1><p class=header-date>作者:
Leehyon HNG
| <span>655 字, 2 分钟</span>
| 2022-11-21
| 分类:
<a href=https://www.kohsruhe.com/zh/category/articles/>articles</a></p><div class=header-underline></div><div class=clearfix></div><p class="float-left header-tags"><i class="fas fa-tags" aria-hidden=true></i>
<a href=https://www.kohsruhe.com/zh/tag/feature/>feature</a>,
<a href=https://www.kohsruhe.com/zh/tag/git/>git</a>,
<a href=https://www.kohsruhe.com/zh/tag/guide/>guide</a></p><div class=clearfix></div><p class="float-right translations"><i class="fas fa-language" aria-hidden=true></i>
-
<a href=https://www.kohsruhe.com/en/2022/11/21/git-submodule-guide/>EN</a></p></div></div></div></div></div><main><div class="container content"><article><h2 id=前言>前言</h2><p>克隆他人项目时，有时候会看到仓库目录下有一个<code>.gitmodules</code>的文本文件，打开后有如下类似内容：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=o>[</span>submodule <span class=s2>&#34;foo/bar&#34;</span><span class=o>]</span>
</span></span><span class=line><span class=cl>	<span class=nv>path</span> <span class=o>=</span> foo/bar
</span></span><span class=line><span class=cl>	<span class=nv>url</span> <span class=o>=</span> https://example.com/foo.git
</span></span><span class=line><span class=cl>	<span class=nv>branch</span> <span class=o>=</span> dev
</span></span></code></pre></div><p>上述内容表面该仓库使用了<code>git submodule</code>方式链接了其他仓库。如果要使用被链接的仓库，需要用以下命令进行初始化：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ git submodule update --init --recursive
</span></span></code></pre></div><h2 id=为什么使用git子模块>为什么使用Git子模块</h2><p>其实背后的思想是模块化设计：</p><ul><li>根据代码功能或维护周期把项目拆分成不同的子模块，并建立不同的Git仓库</li><li>一个模块能被多处使用，通过<code>git submodule</code>进行关联</li><li>主模块不必负责子模块的维护，只在必要时候同步更新</li></ul><p>另外，如果项目依赖一个开源的第三方库时，也建议将第三方库设置为子模块。</p><h2 id=主要内容>主要内容</h2><ul><li>添加子模块到仓库并不会把子模块的源码添加进来，只是添加子模块的信息，比如<code>url</code>和<code>branch</code></li><li>添加后的子模块不会随子模块仓库的更新而自动更新，以保证主仓库的稳定性</li></ul><h3 id=添加子模块>添加子模块</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ git submodule add &lt;submodule_url&gt; &lt;path&gt;
</span></span></code></pre></div><p>执行添加命令成功后，可以在当前路径中看到一个<code>.gitsubmodule</code>文件，里面的内容就是子模块的信息。</p><p>如果在添加子模块的时候想要指定分支，可以利用<code>-b</code>参数：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ git submodule add -b &lt;branch&gt; &lt;url&gt; &lt;path&gt;
</span></span></code></pre></div><p>添加之后，仓库<code>&lt;path></code>目录下不会有任何变化，需要执行下面命令才会添加源码：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ git submodule update --init --recursive
</span></span></code></pre></div><h3 id=更新子模块>更新子模块</h3><p>如果子模块仓库更新了，如有必要，需要手动进行更新，即进入子模块目录，执行<code>git pull</code>命令。</p><h3 id=删除子模块>删除子模块</h3><p>网上搜到的方法有点繁琐，其实可以使用<code>git submodule deinit</code>命令进行“优雅”删除：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ git submodule deinit &lt;submodule_name&gt;
</span></span><span class=line><span class=cl>$ git rm &lt;submodule_name&gt;
</span></span></code></pre></div><p>这个命令如果添加上参数<code>--force</code>，则子模块工作区内即使有本地的修改，也会被移除。</p></article><h2>相关文章</h2><dl class=row></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl></dl><dt class=col-md-3>2022-11-20</dt><dd class=col-md-9><a href=/zh/2022/11/20/git-quick-guide/>Git 快速上手</a></dd></dl></dl></dl></dl><div class=author-card><div class=underline></div><div class=author-box><div class=author-image><a href=/zh><img src=/images/ly.jpg alt="Leehyon HNG"></a></div><div class=author-content><p class=author-title>作者</p><p class=author-name>Leehyon HNG</p><p class=author-desc>嵌入式软件工程师，安徽歙县人。躺不平的不想打工者，爱自由也拥抱规则，生命不止，折腾不休。在 <a href=https://github.com/leehyon>GitHub</a> 关注我，或在 <a href=https://t.me/kohsorbit>Telegram</a>了解更多。</p></div></div></div><div align=center><div class=comment-underline></div></div><br><div id=cusdis_thread data-host=https://kohsruhe.vercel.app data-app-id=ddea9a34-3fb6-495c-b56b-425dc1fa5e70 data-page-id=ab76b855f9abfaaad315f9829e05e250 data-page-url=https://www.kohsruhe.com/zh/2022/11/21/git-submodule-guide/ data-page-title="Git 子模块使用"></div><script defer src=https://cusdis.com/js/widget/lang/zh-cn.js></script>
<script async defer src=https://kohsruhe.vercel.app/js/cusdis.es.js></script></div></main><div class="footer gradient-2"><div class="container footer-container"><div class=row><div class="col-xs-4 col-sm-3 col-md-3 col-lg-3"><div class=footer-title>网站地图</div><ul class=list-unstyled><li><a href=https://www.kohsruhe.com/zh/tags/>标签</a></li><li><a href=https://www.kohsruhe.com/zh/categories/>分类</a></li><li><a rel=alternate type=application/rss+xml href=https://www.kohsruhe.com/zh/index.xml><i class="fas fa-rss-square"></i> RSS</a></li></ul></div><div class="col-xs-4 col-sm-3 col-md-3 col-lg-3"><div class=footer-title>社交</div><ul class=list-unstyled><li><a href=https://t.me/kohsorbit rel=noopener target=_blank>Telegram</a></li><li><a href=https://twitter.com/kohsruhe rel=noopener target=_blank>Twitter</a></li><li><a href rel=noopener target=_blank>Instagram</a></li></ul></div><div class="col-xs-4 col-sm-3 col-md-3 col-lg-3"><div class=footer-title>链接</div><ul class=list-unstyled><li><a href=https://github.com/leehyon rel=noopener target=_blank>Kohs GitHub</a></li><li><a href rel=noopener target=_blank>LinkedIn</a></li><li><a href=https://www.goodreads.com/leehyon rel=noopener target=_blank>goodreads</a></li></ul></div><div class="col-xs-12 col-sm-3 col-md-3 col-lg-3"><p class="pull-right text-right"><small><em>Powered by <a href=https://gohugo.io/ rel=noopener target=_blank>Hugo</a></em></small><br><small><em>Theme - <a href=https://github.com/shaform/hugo-theme-den rel=noopener target=_blank>Den</a></em></small><br><small>&copy;
Leehyon HNG
2022</small></p></div></div></div></div><script src=https://code.jquery.com/jquery-3.3.1.slim.min.js integrity=sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo crossorigin=anonymous></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js integrity=sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49 crossorigin=anonymous></script>
<script src=https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js integrity=sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy crossorigin=anonymous></script></body></html>